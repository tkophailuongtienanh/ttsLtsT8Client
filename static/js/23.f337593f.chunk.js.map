{"version":3,"sources":["pages/User/UserManagement.js"],"names":["roleOption","value","code","label","UserManagement","addToast","useToast","search","setSearch","useState","users","setUsers","currentPage","setCurrentPage","total","setTotal","columns","title","dataIndex","key","render","_","record","React","createElement","Space","size","Fragment","Select","mode","maxTagCount","permissionCodes","onChange","updateUserRole","id","className","style","minWidth","filterOption","showSearch","options","async","userId","response","fetchWithAuth","body","UserId","Permission","data","updatedUsers","map","u","errorCode","message","error","console","log","searchUser","pageIndex","arguments","length","undefined","pageSize","searchStr","getWithAuth","teamMembersWithKey","list","member","permissions","perm","roleId","useEffect","Card","Input","type","placeholder","e","target","Button","onClick","btnSearchClick","Table","dataSource","pagination","Pagination","align","current","curpage"],"mappings":"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","file":"static/js/23.f337593f.chunk.js","sourcesContent":["import { replace } from \"react-router-dom\";\nimport React, { useEffect, useState } from \"react\";\nimport { Button, Card, Input, Pagination, Select, Space, Table } from \"antd\";\nimport fetchWithAuth, { fetchApi, getWithAuth } from \"../../utils/callApi\";\nimport { useToast } from \"../../context/ToastContext\";\n\nconst PAGESIZE = 25;\nconst roleOption = [\n  { value: 1, code: \"Leader\", label: \"Leader\" },\n  { value: 2, code: \"Designer\", label: \"Designer\" },\n  { value: 3, code: \"Deliver\", label: \"Deliver\" },\n  { value: 4, code: \"Manager\", label: \"Manager\" },\n  { value: 5, code: \"Employee\", label: \"Employee\" },\n  { value: 6, code: \"Admin\", label: \"Admin\" },\n];\nconst UserManagement = () => {\n  const addToast = useToast();\n  const [search, setSearch] = useState(\"\");\n  const [users, setUsers] = useState([]);\n  const [currentPage, setCurrentPage] = useState(1);\n  const [total, setTotal] = useState(0);\n  const columns = [\n    {\n      title: \"ID\",\n      dataIndex: \"id\",\n      key: \"id\",\n      // render: (_, record) => <p>{record.age}</p>,\n    },\n    {\n      title: \"Họ và tên\",\n      dataIndex: \"fullName\",\n      key: \"fullName\",\n    },\n    {\n      title: \"Email\",\n      dataIndex: \"email\",\n      key: \"email\",\n    },\n    {\n      title: \"Phone\",\n      dataIndex: \"phoneNumber\",\n      key: \"phoneNumber\",\n    },\n    {\n      title: \"Quyền hạn\",\n      key: \"action\",\n      render: (_, record) => (\n        <Space size=\"middle\">\n          <>\n            <Select\n              mode=\"multiple\"\n              maxTagCount=\"responsive\"\n              value={record.permissionCodes}\n              onChange={(value) => updateUserRole(record.id, value)}\n              //   className=\"block w-full text-sm focus:outline-none dark:text-gray-300 form-input leading-5 focus:border-purple-400 dark:border-gray-600 focus:shadow-outline-purple dark:focus:border-gray-600 dark:focus:shadow-outline-gray dark:bg-gray-700 mt-1\"\n              className=\"w-60 mt-1 \"\n              style={{ minWidth: \"280px\" }}\n              //   labelInValue\n              filterOption={false}\n              showSearch\n              options={roleOption}\n            />\n          </>\n        </Space>\n      ),\n    },\n  ];\n  const updateUserRole = async (userId, value) => {\n    try {\n      const response = await fetchWithAuth(\"Users/UpdateUserPermission\", {\n        body: { UserId: userId, Permission: value },\n      });\n      const data = response.data;\n      if (response.code == \"200\") {\n        const updatedUsers = users.map((u) =>\n          u.id == userId ? { ...u, permissionCodes: value } : u\n        );\n        setUsers(updatedUsers);\n      } else if (response.code) {\n        addToast(\n          \"danger\",\n          response.code + \": \" + data.errorCode + \"-\" + data.message,\n          10000\n        );\n      }\n    } catch (error) {\n      console.log(error);\n    }\n  };\n  const searchUser = async (\n    pageIndex = currentPage - 1,\n    pageSize = PAGESIZE,\n    searchStr = search\n  ) => {\n    try {\n      const response = await getWithAuth(\n        \"Users/GetAll?\" +\n          \"search=\" +\n          searchStr +\n          \"&pageIndex=\" +\n          pageIndex +\n          \"&pageSize=\" +\n          pageSize\n      );\n      const data = response.data;\n\n      if (response.code == \"200\") {\n        const teamMembersWithKey = data.list.map((member) => ({\n          ...member,\n          key: member.id, // Hoặc sử dụng một thuộc tính duy nhất khác\n          permissionCodes: member.permissions.map((perm) => perm.roleId),\n        }));\n        setTotal(data.total);\n        setUsers(teamMembersWithKey);\n      } else if (response.code) {\n        addToast(\n          \"danger\",\n          response.code + \": \" + data.errorCode + \"-\" + data.message,\n          10000\n        );\n      }\n    } catch (error) {}\n  };\n  const btnSearchClick = () => {\n    setCurrentPage(1);\n    searchUser(currentPage - 1, PAGESIZE, search);\n  };\n  const onChange = (curpage, pageSize) => {\n    setCurrentPage(curpage);\n    searchUser(curpage - 1, pageSize);\n  };\n  useEffect(() => {\n    searchUser();\n  }, []);\n  return (\n    <>\n      <Card className=\"mt-5 shadow-md border-0\">\n        <Input\n          className=\"mb-3 p-2 w-1/2 mr-3\"\n          type=\"text\"\n          placeholder=\"Tên, email người dùng\"\n          onChange={(e) => setSearch(e.target.value)}\n          value={search}\n        ></Input>\n        <Button\n          onClick={btnSearchClick}\n          type=\"primary\"\n          size=\"large\"\n          className=\"h-full\"\n        >\n          <i className=\"fa-solid fa-magnifying-glass\"></i> Tìm kiếm\n        </Button>\n        <Table columns={columns} dataSource={users} pagination={false} />\n        <Pagination\n          className=\"mt-2\"\n          align=\"end\"\n          current={currentPage}\n          onChange={onChange}\n          total={total}\n          pageSize={PAGESIZE}\n        />\n      </Card>\n      ;\n    </>\n  );\n};\nexport default UserManagement;\n"],"sourceRoot":""}