{"version":3,"sources":["assets/img/login-office.jpeg","assets/img/login-office-dark.jpeg","pages/Authen/ConfirmEmail.js"],"names":["module","exports","ConfirmEmail","addToast","useToast","lastSent","setLastSent","useState","timeRemaining","setTimeRemaining","optRef","useRef","btnRef","navigate","Cookie","get","useNavigate","useEffect","resendEmail","calculateTimeRemaining","elapsed","Date","now","remaining","parseInt","Math","max","disableRightBtn","enableRightBtn","interval","setInterval","clearInterval","async","response","getWithAuth","data","code","message","errorCode","fetchData","React","createElement","className","aria-hidden","src","ImageLight","alt","ImageDark","Label","ref","placeholder","onClick","disabled","fetchWithAuth","method","body","current","value","error","console"],"mappings":"gIAAAA,EAAOC,QAAU,IAA0B,2C,oBCA3CD,EAAOC,QAAU,IAA0B,gD,iCCA3C,gIAoJeC,UAxIf,WACE,MAAM,SAAEC,GAAaC,eACdC,EAAUC,GAAeC,mBAAS,OAClCC,EAAeC,GAAoBF,mBAAS,GAC7CG,EAASC,iBAAO,IAChBC,EAASD,mBAETE,GADQC,IAAOC,IAAI,SACRC,eAsBjBC,oBAAU,KACRC,KACC,IACHD,oBAAU,KACR,MAAME,EAAyBA,KAC7B,GAAId,EAAU,CACZ,MAAMe,EAAUC,KAAKC,MAAQjB,EACvBkB,EAAYC,SAASC,KAAKC,IAAI,EAAG,IAAQN,GAAW,KAC1DX,EAAiBc,GACbA,EAAY,EACdI,YAAgBf,GAEhBgB,YAAehB,KAKrBO,IACA,MAAMU,EAAWC,YAAY,KAC3BX,KACC,KAEH,MAAO,IAAMY,cAAcF,IAC1B,CAACxB,IACJ,MAAMa,EAAcA,KAClB,GAAIV,EAAgB,EAClB,OAEgBwB,WAChB,MAAMC,QAAiBC,YAAY,qCAC7BC,EAAOF,EAASE,KAED,OAAjBF,EAASG,MACX9B,EAAYe,KAAKC,OACjBnB,EAAS,UAAWgC,EAAKE,QAAS,MACzBJ,EAASG,MAClBjC,EACE,SACA8B,EAASG,KAAO,KAAOD,EAAKG,UAAY,IAAMH,EAAKE,QACnD,MAINE,IAEF,OACEC,IAAAC,cAAA,OAAKC,UAAU,kEACbF,IAAAC,cAAA,OAAKC,UAAU,kGACbF,IAAAC,cAAA,OAAKC,UAAU,6CACbF,IAAAC,cAAA,OAAKC,UAAU,2BACbF,IAAAC,cAAA,OACEE,cAAY,OACZD,UAAU,yCACVE,IAAKC,IACLC,IAAI,WAENN,IAAAC,cAAA,OACEE,cAAY,OACZD,UAAU,+CACVE,IAAKG,IACLD,IAAI,YAGRN,IAAAC,cAAA,QAAMC,UAAU,yDACdF,IAAAC,cAAA,OAAKC,UAAU,UACbF,IAAAC,cAAA,MAAIC,UAAU,+DAA8D,iBAG5EF,IAAAC,cAAA,KAAGC,UAAU,kBAAiB,4DAG9BF,IAAAC,cAACO,QAAK,CAACN,UAAU,QACfF,IAAAC,cAAA,YAAM,OACND,IAAAC,cAAA,OAAKC,UAAU,uDACbF,IAAAC,cAAA,SACEQ,IAAKvC,EACLgC,UAAU,yNAGVQ,YAAY,WAEdV,IAAAC,cAAA,UACEQ,IAAKrC,EACLuC,QAASjC,EACTkC,SAAU5C,EAAgB,EAC1BkC,UAAU,wPACX,qBACUlC,EAAgB,GAAK,KAAOA,EAAgB,QAI3DgC,IAAAC,cAAA,UACEC,UAAU,8MAGVS,QAnHOnB,UACnB,IACE,MAAMC,QAAiBoB,YAAc,8BAA+B,CAClEC,OAAQ,OACRC,KAAM7C,EAAO8C,QAAQC,QAEjBtB,EAAOF,EAASE,KACD,OAAjBF,EAASG,KACXvB,EAAS,QACAoB,EAASG,MAClBjC,EACE,SACA8B,EAASG,KAAO,KAAOD,EAAKG,UAAY,IAAMH,EAAKE,QACnD,KAGJ,MAAOqB,GACPC,QAAQD,MAAM,uBAAwBA,MAmG7B","file":"static/js/11.587e58c8.chunk.js","sourcesContent":["module.exports = __webpack_public_path__ + \"static/media/login-office.72742c2e.jpeg\";","module.exports = __webpack_public_path__ + \"static/media/login-office-dark.cb4a995f.jpeg\";","import React, { useEffect, useRef, useState } from \"react\";\nimport { Link, useNavigate } from \"react-router-dom\";\n\nimport ImageLight from \"../../assets/img/login-office.jpeg\";\nimport ImageDark from \"../../assets/img/login-office-dark.jpeg\";\nimport { GithubIcon, TwitterIcon } from \"../../icons\";\nimport { Label, Input, Button } from \"@windmill/react-ui\";\nimport Cookie from \"js-cookie\";\nimport fetchWithAuth, { getWithAuth } from \"../../utils/callApi\";\nimport { useToast } from \"../../context/ToastContext\";\nimport { disableRightBtn, enableRightBtn } from \"../../utils/formValid\";\n\nfunction ConfirmEmail() {\n  const { addToast } = useToast();\n  const [lastSent, setLastSent] = useState(null);\n  const [timeRemaining, setTimeRemaining] = useState(0);\n  const optRef = useRef(\"\");\n  const btnRef = useRef();\n  const token = Cookie.get(\"token\");\n  const navigate = useNavigate();\n\n  const confirmClick = async () => {\n    try {\n      const response = await fetchWithAuth(\"Authentication/ConfirmEmail\", {\n        method: \"POST\",\n        body: optRef.current.value,\n      });\n      const data = response.data;\n      if (response.code == \"200\") {\n        navigate(\"/app\");\n      } else if (response.code) {\n        addToast(\n          \"danger\",\n          response.code + \": \" + data.errorCode + \"-\" + data.message,\n          10000\n        );\n      }\n    } catch (error) {\n      console.error(\"Error fetching data:\", error);\n    }\n  };\n  useEffect(() => {\n    resendEmail();\n  }, []);\n  useEffect(() => {\n    const calculateTimeRemaining = () => {\n      if (lastSent) {\n        const elapsed = Date.now() - lastSent;\n        const remaining = parseInt(Math.max(0, 60000 - elapsed) / 1000); // 60000 ms = 1 minute\n        setTimeRemaining(remaining);\n        if (remaining > 0) {\n          disableRightBtn(btnRef);\n        } else {\n          enableRightBtn(btnRef);\n        }\n      }\n    };\n\n    calculateTimeRemaining();\n    const interval = setInterval(() => {\n      calculateTimeRemaining();\n    }, 1000);\n\n    return () => clearInterval(interval);\n  }, [lastSent]);\n  const resendEmail = () => {\n    if (timeRemaining > 0) {\n      return;\n    }\n    const fetchData = async () => {\n      const response = await getWithAuth(\"Authentication/ConfirmEmailInvoke\");\n      const data = response.data;\n\n      if (response.code == \"200\") {\n        setLastSent(Date.now());\n        addToast(\"success\", data.message, 30000);\n      } else if (response.code) {\n        addToast(\n          \"danger\",\n          response.code + \": \" + data.errorCode + \"-\" + data.message,\n          10000\n        );\n      }\n    };\n    fetchData();\n  };\n  return (\n    <div className=\"flex items-center min-h-screen p-6 bg-gray-50 dark:bg-gray-900\">\n      <div className=\"flex-1 h-full max-w-4xl mx-auto overflow-hidden bg-white rounded-lg shadow-xl dark:bg-gray-800\">\n        <div className=\"flex flex-col overflow-y-auto md:flex-row\">\n          <div className=\"h-32 md:h-auto md:w-1/2\">\n            <img\n              aria-hidden=\"true\"\n              className=\"object-cover w-full h-full dark:hidden\"\n              src={ImageLight}\n              alt=\"Office\"\n            />\n            <img\n              aria-hidden=\"true\"\n              className=\"hidden object-cover w-full h-full dark:block\"\n              src={ImageDark}\n              alt=\"Office\"\n            />\n          </div>\n          <main className=\"flex items-center justify-center p-6 sm:p-12 md:w-1/2\">\n            <div className=\"w-full\">\n              <h1 className=\"mb-4 text-xl font-semibold text-gray-700 dark:text-gray-200\">\n                Confirm Email\n              </h1>\n              <p className=\"text-green-500\">\n                We sent you an OTP to your email. Please check your mail\n              </p>\n              <Label className=\"mt-4\">\n                <span>Otp</span>\n                <div className=\"relative text-gray-500 focus-within:text-purple-600\">\n                  <input\n                    ref={optRef}\n                    className=\"block w-full pr-20 mt-1 text-sm text-black dark:text-gray-300 dark:border-gray-600 \n                    dark:bg-gray-700 focus:border-purple-400 focus:outline-none focus:shadow-outline-purple \n                    dark:focus:shadow-outline-gray form-input\"\n                    placeholder=\"xxxxxx\"\n                  />\n                  <button\n                    ref={btnRef}\n                    onClick={resendEmail}\n                    disabled={timeRemaining > 0}\n                    className=\"absolute inset-y-0 right-0 px-4 text-sm font-medium leading-5 text-white transition-colors duration-150 bg-purple-600 border border-transparent rounded-r-md active:bg-purple-600 hover:bg-purple-700 focus:outline-none focus:shadow-outline-purple\"\n                  >\n                    Gửi lại {timeRemaining > 0 && \" (\" + timeRemaining + \"s)\"}\n                  </button>\n                </div>\n              </Label>\n              <button\n                className=\"transition-colors duration-150 font-medium focus:outline-none  \n                py-2 rounded-lg text-sm text-white bg-purple-600 border-0 active:bg-purple-600 \n                hover:bg-purple-700 focus:shadow-outline-purple w-full mt-4\"\n                onClick={confirmClick}\n              >\n                Confirm\n              </button>\n            </div>\n          </main>\n        </div>\n      </div>\n    </div>\n  );\n}\n\nexport default ConfirmEmail;\n"],"sourceRoot":""}