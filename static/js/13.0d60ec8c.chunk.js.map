{"version":3,"sources":["assets/img/login-office.jpeg","assets/img/login-office-dark.jpeg","pages/Authen/Login.js"],"names":["module","exports","Login","navigate","useNavigate","addToast","useToast","token","setToken","useState","Cookie","get","emailRef","useRef","passRef","useEffect","url","headers","console","log","config","method","async","response","fetch","ok","data","json","errorCode","window","location","href","callApi","error","React","createElement","className","aria-hidden","src","ImageLight","alt","ImageDark","Label","Input","ref","type","placeholder","onClick","checkNull","userLogin","email","current","value","password","fetchApi","body","code","set","JSON","stringify","role","message","Link","to"],"mappings":"gIAAAA,EAAOC,QAAU,IAA0B,2C,oBCA3CD,EAAOC,QAAU,IAA0B,gD,iCCA3C,wIAwJeC,UA5If,WACE,MAAMC,EAAWC,eACX,SAAEC,GAAaC,eACdC,EAAOC,GAAYC,mBAASC,IAAOC,IAAI,UACxCC,EAAWC,mBACXC,EAAUD,mBA4DhB,OA3DAE,oBAAU,KACR,IACE,MAAMC,EAAM,gDACNC,EAAU,CACd,eAAgB,oBAEdV,IACFU,EAAuB,cAAI,UAAUV,GAEvCW,QAAQC,IAAI,2BAA4BF,EAAuB,eAG/D,MAAMG,EAAS,CACbC,OAAQ,MACRJ,WAGcK,WACd,MAAMC,QAAiBC,MAAMR,EAAKI,GAClC,GAAIG,EAASE,GAAI,CACf,IAAIC,QAAaH,EAASI,OAC1BT,QAAQC,IAAI,OAAQO,GACE,MAAlBA,EAAKE,WACPvB,EAAS,SAAU,qEAAuC,KAC1DF,EAAS,kBACJ0B,OAAOC,SAASC,KAAO,SAGlCC,GACA,MAAOC,MACR,CAAC1B,IA8BF2B,IAAAC,cAAA,OAAKC,UAAU,kEACbF,IAAAC,cAAA,OAAKC,UAAU,kGACbF,IAAAC,cAAA,OAAKC,UAAU,6CACbF,IAAAC,cAAA,OAAKC,UAAU,2BACbF,IAAAC,cAAA,OACEE,cAAY,OACZD,UAAU,yCACVE,IAAKC,IACLC,IAAI,WAENN,IAAAC,cAAA,OACEE,cAAY,OACZD,UAAU,+CACVE,IAAKG,IACLD,IAAI,YAGRN,IAAAC,cAAA,QAAMC,UAAU,yDACdF,IAAAC,cAAA,OAAKC,UAAU,UACbF,IAAAC,cAAA,MAAIC,UAAU,+DAA8D,SAG5EF,IAAAC,cAACO,QAAK,KACJR,IAAAC,cAAA,YAAM,SACND,IAAAC,cAACQ,QAAK,CACJC,IAAKhC,EACLwB,UAAU,OACVS,KAAK,QACLC,YAAY,kBAGhBZ,IAAAC,cAACO,QAAK,CAACN,UAAU,QACfF,IAAAC,cAAA,YAAM,YACND,IAAAC,cAACQ,QAAK,CACJC,IAAK9B,EACLsB,UAAU,OACVS,KAAK,WACLC,YAAY,qBAGhBZ,IAAAC,cAAA,UACEC,UAAU,kNAGVW,QAzEQzB,UACpB,IAAK0B,YAAUpC,KAAcoC,YAAUlC,GAAU,OACjD,MAAMmC,EAAY,CAChBC,MAAOtC,EAASuC,QAAQC,MACxBC,SAAUvC,EAAQqC,QAAQC,OAE5BlC,QAAQC,IAAI,MAAO8B,GAEnB,MAAM1B,QAAiB+B,YAAS,uBAAwB,CACtDjC,OAAQ,OACRkC,KAAMN,IAGFvB,EAAOH,EAASG,KACD,OAAjBH,EAASiC,MACXtC,QAAQC,IAAIO,GAEZhB,IAAO+C,IAAI,QAAS/B,EAAKnB,OACzBG,IAAO+C,IAAI,OAAQC,KAAKC,UAAUjC,EAAKkC,OACvCpD,EAASkB,EAAKnB,QACLgB,EAASiC,MAClBnD,EACE,SACAkB,EAASiC,KAAO,KAAO9B,EAAKE,UAAY,IAAMF,EAAKmC,QACnD,OAkDO,UAID3B,IAAAC,cAAA,MAAIC,UAAU,SACdF,IAAAC,cAAA,KAAGC,UAAU,QACXF,IAAAC,cAAC2B,IAAI,CACH1B,UAAU,2EACV2B,GAAG,oBACJ,0BAIH7B,IAAAC,cAAA,KAAGC,UAAU,QACXF,IAAAC,cAAC2B,IAAI,CACH1B,UAAU,2EACV2B,GAAG,mBACJ","file":"static/js/13.0d60ec8c.chunk.js","sourcesContent":["module.exports = __webpack_public_path__ + \"static/media/login-office.72742c2e.jpeg\";","module.exports = __webpack_public_path__ + \"static/media/login-office-dark.cb4a995f.jpeg\";","import React, { useEffect, useRef, useState } from \"react\";\r\nimport { Link, useNavigate } from \"react-router-dom\";\r\n\r\nimport ImageLight from \"../../assets/img/login-office.jpeg\";\r\nimport ImageDark from \"../../assets/img/login-office-dark.jpeg\";\r\nimport { GithubIcon, TwitterIcon } from \"../../icons\";\r\nimport { Label, Input, Button } from \"@windmill/react-ui\";\r\nimport Cookie from \"js-cookie\";\r\nimport { fetchWithAuth, fetchApi } from \"../../utils/callApi\";\r\nimport checkNull from \"../../utils/formValid\";\r\nimport { useToast } from \"../../context/ToastContext\";\r\n\r\nfunction Login() {\r\n  const navigate = useNavigate();\r\n  const { addToast } = useToast();\r\n  const [token, setToken] = useState(Cookie.get(\"token\"));\r\n  const emailRef = useRef();\r\n  const passRef = useRef();\r\n  useEffect(() => {\r\n    try {\r\n      const url = \"https://localhost:7242/api/Authentication/Get\";\r\n      const headers = {\r\n        \"Content-Type\": \"application/json\",\r\n      };\r\n      if (token) {\r\n        headers[\"Authorization\"] = `Bearer ${token}`;\r\n      }\r\n      console.log(\"headers['Authorization']\", headers[\"Authorization\"]);\r\n\r\n      // Thiết lập cấu hình cho fetch\r\n      const config = {\r\n        method: \"GET\", // Mặc định là GET\r\n        headers,\r\n      };\r\n\r\n      const callApi = async () => {\r\n        const response = await fetch(url, config);\r\n        if (response.ok) {\r\n          var data = await response.json();\r\n          console.log(\"data\", data);\r\n          if (data.errorCode == 1005) {\r\n            addToast(\"danger\", \"Vui lòng xác thực email để tiếp tục\", 10000);\r\n            navigate(\"/confirmEmail\");\r\n          } else window.location.href = \"/app\";\r\n        }\r\n      };\r\n      callApi();\r\n    } catch (error) {}\r\n  }, [token]);\r\n  const loginBtnClick = async () => {\r\n    if (!checkNull(emailRef) || !checkNull(passRef)) return;\r\n    const userLogin = {\r\n      email: emailRef.current.value,\r\n      password: passRef.current.value,\r\n    };\r\n    console.log(\"log\", userLogin);\r\n\r\n    const response = await fetchApi(\"Authentication/Login\", {\r\n      method: \"POST\",\r\n      body: userLogin,\r\n    });\r\n\r\n    const data = response.data;\r\n    if (response.code == \"200\") {\r\n      console.log(data);\r\n\r\n      Cookie.set(\"token\", data.token);\r\n      Cookie.set(\"role\", JSON.stringify(data.role));\r\n      setToken(data.token);\r\n    } else if (response.code) {\r\n      addToast(\r\n        \"danger\",\r\n        response.code + \": \" + data.errorCode + \"-\" + data.message,\r\n        10000\r\n      );\r\n    }\r\n  };\r\n  return (\r\n    <div className=\"flex items-center min-h-screen p-6 bg-gray-50 dark:bg-gray-900\">\r\n      <div className=\"flex-1 h-full max-w-4xl mx-auto overflow-hidden bg-white rounded-lg shadow-xl dark:bg-gray-800\">\r\n        <div className=\"flex flex-col overflow-y-auto md:flex-row\">\r\n          <div className=\"h-32 md:h-auto md:w-1/2\">\r\n            <img\r\n              aria-hidden=\"true\"\r\n              className=\"object-cover w-full h-full dark:hidden\"\r\n              src={ImageLight}\r\n              alt=\"Office\"\r\n            />\r\n            <img\r\n              aria-hidden=\"true\"\r\n              className=\"hidden object-cover w-full h-full dark:block\"\r\n              src={ImageDark}\r\n              alt=\"Office\"\r\n            />\r\n          </div>\r\n          <main className=\"flex items-center justify-center p-6 sm:p-12 md:w-1/2\">\r\n            <div className=\"w-full\">\r\n              <h1 className=\"mb-4 text-xl font-semibold text-gray-700 dark:text-gray-200\">\r\n                Login\r\n              </h1>\r\n              <Label>\r\n                <span>Email</span>\r\n                <Input\r\n                  ref={emailRef}\r\n                  className=\"mt-1\"\r\n                  type=\"email\"\r\n                  placeholder=\"john@doe.com\"\r\n                />\r\n              </Label>\r\n              <Label className=\"mt-4\">\r\n                <span>Password</span>\r\n                <Input\r\n                  ref={passRef}\r\n                  className=\"mt-1\"\r\n                  type=\"password\"\r\n                  placeholder=\"***************\"\r\n                />\r\n              </Label>\r\n              <button\r\n                className=\"transition-colors duration-150 font-medium focus:outline-none  \r\n                py-2 rounded-lg text-sm text-white bg-purple-600 border-0 active:bg-purple-600 \r\n                hover:bg-purple-700 focus:shadow-outline-purple w-full mt-4\"\r\n                onClick={loginBtnClick}\r\n              >\r\n                Log in\r\n              </button>\r\n\r\n              <hr className=\"my-8\" />\r\n              <p className=\"mt-4\">\r\n                <Link\r\n                  className=\"text-sm font-medium text-purple-600 dark:text-purple-400 hover:underline\"\r\n                  to=\"/forgot-password\"\r\n                >\r\n                  Forgot your password?\r\n                </Link>\r\n              </p>\r\n              <p className=\"mt-1\">\r\n                <Link\r\n                  className=\"text-sm font-medium text-purple-600 dark:text-purple-400 hover:underline\"\r\n                  to=\"/create-account\"\r\n                >\r\n                  Create account\r\n                </Link>\r\n              </p>\r\n            </div>\r\n          </main>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default Login;\r\n"],"sourceRoot":""}